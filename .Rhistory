ryx <- function(data, y, x){
if(missing(x)){
x <- names(data)[sapply(data, class)=="numeric"]
x <- setdiff(x, y)
}
df <- data.frame()
for (var in x){
res <- cor.test(data[[y]], data[[var]])
df_temp <- data.frame(variable = var,
r = res$estimate,
p = res$p.value)
df <- rbind(df, df_temp)
df <- df[order(-abs(df$r)),]
}
df$sigif <- ifelse(df$p < .001, "***",
ifelse(df$p < .01, "**",
ifelse(df$p < .05, "*", " ")))
results <- list(y=y, x=x, df=df)
class(results) <- "ryx"
return(results)
}
library(MASS)
x <- ryx(Boston, y="medv")
print(x)
print.ryx <- function(x,...){
if(!inherits(x, "ryx")) stop("must be ryx")
print("Correlations of "+y+" with\n")
print(x$df)
}
print(x)
View(x)
print.ryx <- function(x,...){
if(!inherits(x, "ryx")) stop("must be ryx")
print("Correlations of "+x$y+" with\n")
print(x$df)
}
print(x)
x$y
class(x$y)
cat("Correlations of "+x$y+" with\n"
cat("Correlations of "+x$y+" with\n")
cat("Correlations of "+x$y+" with\n")
cat("Correlations of ",x$y," with\n")
cat("Correlations of",x$y,"with\n")
print(cat("Correlations of",x$y,"with\n"))
print.ryx <- function(x,...){
if(!inherits(x, "ryx")) stop("must be ryx")
print(cat("Correlations of",x$y,"with\n"))
print(x$df)
}
print(x)
print("Correlations of",x$y,"with\n")
print.ryx <- function(x,...){
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlations of",x$y,"with\n")
print(x$df)
}
print(x)
print.ryx <- function(x,...){
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlations of",x$y,"with\n")
print(x$df, row.names = F)
}
print(x)
colnames(x$d)
colnames(x$df)
x$df$variable
data(Boston)
View(Boston)
x$df$variable
x$x
summary.ryx <- function(x,...) {
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlating",x$y,"with",x$x,"\n")
}
summary(x)
median(x$df$r)
median(abs(x$df$r))
round(median(abs(x$df$r)), 3)
round(range(x$df$r), 3)
class(round(range(x$df$r), 3))
tst <- round(range(x$df$r), 3)
round(range(x$df$r), 3)[1]
round(range(x$df$r), 3)[2]
summary.ryx <- function(x,...) {
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlating",x$y,"with",x$x,"\n")
cat("The median absolute correlation was",round(median(abs(x$df$r)), 3),
"with a range from",round(range(x$df$r), 3)[1],"to",round(range(x$df$r), 3)[2],"\n")
}
summary(x)
?grepl
grepl("*", x$df$sigif)
sum(grepl("*", x$df$sigif))
length(x$df)
nrows(x$df)
nrow(x$df)
summary.ryx <- function(x,...) {
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlating",x$y,"with",x$x,"\n")
cat("The median absolute correlation was",round(median(abs(x$df$r)), 3),
"with a range from",round(range(x$df$r), 3)[1],"to",round(range(x$df$r), 3)[2],"\n")
cat(sum(grepl("*", x$df$sigif)),"out of",nrow(x$df),"variables were significant at the p < 0.05 level")
}
summary(x)
summary.ryx <- function(x,...) {
if(!inherits(x, "ryx")) stop("must be ryx")
cat("Correlating",x$y,"with",x$x,"\n")
cat("The median absolute correlation was",round(median(abs(x$df$r)), 3),
"with a range from",round(range(x$df$r), 3)[1],"to",round(range(x$df$r), 3)[2],"\n")
cat(" ",sum(grepl("*", x$df$sigif)),"out of",nrow(x$df),"variables were significant at the p < 0.05 level.")
}
summary(x)
x$df$r
abs(x$df$r)
ggplot(x$df,
aes(x = abs(r))) +
geom_bar()
library(ggplot2)
ggplot(x$df,
aes(x = abs(r))) +
geom_bar()
ggplot(x$df,
aes(y = abs(r))) +
geom_bar()
ggplot(x,
aes(x=x,
y = abs(df$r))) +
geom_bar()
ggplot(x,
aes(x= .data[[x$x]],
y = abs(df$r))) +
geom_bar()
ggplot(x$df,
aes(x= variable,
y = abs(r))) +
geom_bar()
ggplot(x$df,
aes(y = variable,
x = abs(r))) +
geom_bar()
ggplot(x$df,
aes(x = abs(r))) +
geom_bar()
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_bar(stat = "identity")
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_scatter()
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_point()
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point()
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_line()
ggplot(x$df,
aes(x = abs(r),
y = variable), group = 0) +
geom_point() +
geom_line()
ggplot(x$df,
aes(x = abs(r),
y = variable), group = 1) +
geom_point() +
geom_line()
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_line(group = 1)
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_line(group = 0)
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_line()
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_bar(stat = "identity",width=0.01) +
coord_flip()
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_bar(stat = "identity",width=0.01)
ggplot(x$df,
aes(x = abs(r),
y = variable)) +
geom_point() +
geom_bar(stat = "identity",width=0.01) +
coord_flip()
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_point() +
geom_bar(stat = "identity",width=0.01) +
coord_flip()
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_point() +
geom_bar(stat = "identity",width=0.05) +
coord_flip()
ggplot(x$df,
aes(x = variable,
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip()
x$df
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip()
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
scale_x_reverse() +
coord_flip()
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip()
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip() +
scale_y_reverse()
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip() +
scale_x_reverse()
ggplot(x$df,
aes(x = factor(variable, level = unique(variable)),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip()
ggplot(x$df,
aes(x = factor(variable, level = rev(unique(variable))),
y = abs(r))) +
geom_point() +
geom_segment(aes(xend=variable), yend=0) +
coord_flip()
